!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.feathersMemory=e():t.feathersMemory=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,r){"use strict";(function(t){function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.stripSlashes=function(t){return t.replace(/^(\/*)|(\/*)$/g,"")};var i=e._={each:function(t,e){t&&"function"==typeof t.forEach?t.forEach(e):i.isObject(t)&&Object.keys(t).forEach(function(r){return e(t[r],r)})},some:function(t,e){return Object.keys(t).map(function(e){return[t[e],e]}).some(function(t){var r=o(t,2),n=r[0],i=r[1];return e(n,i)})},every:function(t,e){return Object.keys(t).map(function(e){return[t[e],e]}).every(function(t){var r=o(t,2),n=r[0],i=r[1];return e(n,i)})},keys:function(t){return Object.keys(t)},values:function(t){return i.keys(t).map(function(e){return t[e]})},isMatch:function(t,e){return i.keys(e).every(function(r){return t[r]===e[r]})},isEmpty:function(t){return 0===i.keys(t).length},isObject:function(t){return"object"===(void 0===t?"undefined":n(t))&&!Array.isArray(t)&&null!==t},extend:function(){return Object.assign.apply(Object,arguments)},omit:function(t){for(var e=i.extend({},t),r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.forEach(function(t){return delete e[t]}),e},pick:function(t){for(var e={},r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.forEach(function(r){void 0!==t[r]&&(e[r]=t[r])}),e},merge:function(t,e){return i.isObject(t)&&i.isObject(e)&&Object.keys(e).forEach(function(n){i.isObject(e[n])?(t[n]||Object.assign(t,r({},n,{})),i.merge(t[n],e[n])):Object.assign(t,r({},n,e[n]))}),t}};e.select=function(t){for(var e=t&&t.query&&t.query.$select,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];Array.isArray(e)&&n.length&&e.push.apply(e,n);var u=function(t){return Array.isArray(e)?i.pick.apply(i,[t].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(e))):t};return function(t){return Array.isArray(t)?t.map(u):u(t)}},e.sorter=function(t){return function(e,r){var n=0;return i.each(t,function(t,o){t=parseInt(t,10),e[o]<r[o]&&(n-=1*t),e[o]>r[o]&&(n+=1*t)}),n}},e.isPromise=function(t){return i.isObject(t)&&"function"==typeof t.then},e.makeUrl=function(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="function"==typeof n.get?n.get.bind(n):function(){},i=o("env")||"production",u=o("host")||t.env.HOST_NAME||"localhost",a="development"===i||"test"===i||void 0===i?"http":"https",c=o("port")||t.env.PORT||3030;return r=r||"",a+"://"+u+("development"===i||"test"===i||void 0===i?":"+c:"")+"/"+e.stripSlashes(r)}}).call(e,r(1))},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(e){try{return s.call(null,t,0)}catch(e){return s.call(this,t,0)}}}function i(){h&&p&&(h=!1,p.length?y=p.concat(y):d=-1,y.length&&u())}function u(){if(!h){var t=o(i);h=!0;for(var e=y.length;e;){for(p=y,y=[];++d<e;)p&&p[d].run();d=-1,e=y.length}p=null,h=!1,function(t){if(f===clearTimeout)return clearTimeout(t);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function c(){}var s,f,l=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(t){f=n}}();var p,y=[],h=!1,d=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];y.push(new a(t,e)),1!==y.length||h||o(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=c,l.addListener=c,l.once=c,l.off=c,l.removeListener=c,l.removeAllListeners=c,l.emit=c,l.prependListener=c,l.prependOnceListener=c,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e,r){"use strict";function n(t){return!0===o(t)&&"[object Object]"===Object.prototype.toString.call(t)}var o=r(13);t.exports=function(t){var e,r;return!1!==n(t)&&("function"==typeof(e=t.constructor)&&(r=e.prototype,!1!==n(r)&&!1!==r.hasOwnProperty("isPrototypeOf")))}},function(t,e,r){"use strict";var n=r(2);t.exports=function(t){return n(t)||"function"==typeof t||Array.isArray(t)}},function(t,e,r){"use strict";t.exports=function(t,e,r){for(var n in t)if(!1===e.call(r,t[n],n,t))break}},function(t,e){function r(t){return t.constructor?t.constructor.name:null}var n=Object.prototype.toString;t.exports=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e=typeof t;if("boolean"===e)return"boolean";if("string"===e)return"string";if("number"===e)return"number";if("symbol"===e)return"symbol";if("function"===e)return function(t,e){return"GeneratorFunction"===r(t)}(t)?"generatorfunction":"function";if(function(t){return Array.isArray?Array.isArray(t):t instanceof Array}(t))return"array";if(function(t){return!(!t.constructor||"function"!=typeof t.constructor.isBuffer)&&t.constructor.isBuffer(t)}(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(t))return"arguments";if(function(t){return t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate}(t))return"date";if(function(t){return t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit}(t))return"error";if(function(t){return t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global}(t))return"regexp";switch(r(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(t){return"function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next}(t))return"generator";switch(e=n.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return e.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(t,e,r){"use strict";function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=r(7),u=r(8),a=r(12),c=r(17),s=c.sorter,f=c.select,l=c.filterQuery,p=c._,y=r(21),h=function(){var t=f.apply(void 0,arguments);return function(e){return t(a(e))}},d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paginate=e.paginate||{},this._id=this.id=e.idField||e.id||"id",this._uId=e.startId||0,this.store=e.store||{},this.events=e.events||[],this._matcher=e.matcher,this._sorter=e.sorter||s}return o(t,[{key:"extend",value:function(t){return i.extend(t,this)}},{key:"_find",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:l)(t.query||{}),r=e.query,n=e.filters,o=h(t),i=p.values(this.store),u=(i=this._matcher?i.filter(this._matcher(r)):y(r,i)).length;return n.$sort&&i.sort(this._sorter(n.$sort)),n.$skip&&(i=i.slice(n.$skip)),void 0!==n.$limit&&(i=i.slice(0,n.$limit)),Promise.resolve({total:u,limit:n.$limit,skip:n.$skip||0,data:o(i)})}},{key:"find",value:function(t){var e=void 0!==t.paginate?t.paginate:this.paginate,r=this._find(t,function(t){return l(t,e)});return e&&e.default?r:r.then(function(t){return t.data})}},{key:"get",value:function(t,e){return t in this.store?Promise.resolve(this.store[t]).then(h(e,this.id)):Promise.reject(new u.NotFound("No record found for id '"+t+"'"))}},{key:"_create",value:function(t,e){var r=t[this._id]||this._uId++,o=p.extend({},t,n({},this._id,r));return Promise.resolve(this.store[r]=o).then(h(e,this.id))}},{key:"create",value:function(t,e){var r=this;return Array.isArray(t)?Promise.all(t.map(function(t){return r._create(t)})):this._create(t,e)}},{key:"_update",value:function(t,e,r){if(t in this.store){var o=this.store[t][this._id];return t=o==t?o:t,e=p.extend({},e,n({},this._id,t)),this.store[t]=e,Promise.resolve(this.store[t]).then(h(r,this.id))}return Promise.reject(new u.NotFound("No record found for id '"+t+"'"))}},{key:"update",value:function(t,e,r){return null===t||Array.isArray(e)?Promise.reject(new u.BadRequest("You can not replace multiple instances. Did you mean 'patch'?")):this._update(t,e,r)}},{key:"_patch",value:function(t,e,r){return t in this.store?(p.extend(this.store[t],p.omit(e,this._id)),Promise.resolve(this.store[t]).then(h(r,this.id))):Promise.reject(new u.NotFound("No record found for id '"+t+"'"))}},{key:"patch",value:function(t,e,r){var n=this;return null===t?this._find(r).then(function(t){return Promise.all(t.data.map(function(t){return n._patch(t[n._id],e,r)}))}):this._patch(t,e,r)}},{key:"_remove",value:function(t,e){if(t in this.store){var r=this.store[t];return delete this.store[t],Promise.resolve(r).then(h(e,this.id))}return Promise.reject(new u.NotFound("No record found for id '"+t+"'"))}},{key:"remove",value:function(t,e){var r=this;return null===t?this._find(e).then(function(t){return Promise.all(t.data.map(function(t){return r._remove(t[r._id],e)}))}):this._remove(t,e)}}]),t}();t.exports=function(t){return new d(t)},t.exports.Service=d},function(t,e,r){var n,o,i;!function(r,u){o=[],void 0!==(i="function"==typeof(n=u)?n.apply(e,o):n)&&(t.exports=i)}(0,function(){function t(t,e,r,n){return function(){var o=this._super;this._super="function"==typeof e?e:t[r];var i=n.apply(this,arguments);return this._super=o,i}}return{create:function(){var t=Object.create(this),e="string"==typeof t.__init?t.__init:"init";return"function"==typeof t[e]&&t[e].apply(t,arguments),t},mixin:"function"==typeof Object.defineProperty?function(e,r){var n=r||this,o=/\b_super\b/,i=Object.getPrototypeOf(n)||n.prototype,u={},a=e,c=function(t){u[t]||(u[t]=Object.getOwnPropertyDescriptor(a,t))};do{Object.getOwnPropertyNames(a).forEach(c)}while((a=Object.getPrototypeOf(a))&&Object.getPrototypeOf(a));return Object.keys(u).forEach(function(e){var r=u[e];"function"==typeof r.value&&o.test(r.value)&&(r.value=t(i,n[e],e,r.value)),Object.defineProperty(n,e,r)}),n}:function(e,r){var n,o=r||this,i=/\b_super\b/,u=Object.getPrototypeOf(o)||o.prototype;for(var a in e)n=o[a],("function"==typeof e[a]&&"function"==typeof u[a]||"function"==typeof n&&"function"==typeof e[a])&&i.test(e[a])?o[a]=t(u,n,a,e[a]):o[a]=e[a];return o},extend:function(t,e){return this.mixin(t,Object.create(e||this))},proxy:function(t){var e=this[t],r=Array.prototype.slice.call(arguments,1);return r.unshift(this),e.bind.apply(e,r)}}})},function(t,e,r){"use strict";function n(t,e,r,o,i){var u=void 0,a=void 0,c=void 0;(t=t||"Error")instanceof Error?(a=t.message||"Error",t.errors&&(u=t.errors)):"object"===(void 0===t?"undefined":C(t))?(a=t.message||"Error",i=t):a=t,i&&((c=JSON.parse(JSON.stringify(i))).errors?(u=c.errors,delete c.errors):i.errors&&(u=JSON.parse(JSON.stringify(i.errors)))),this.type="FeathersError",this.name=e,this.message=a,this.code=r,this.className=o,this.data=c,this.errors=u||{},w(this.name+"("+this.code+"): "+this.message),w(this.errors),Error.captureStackTrace?Error.captureStackTrace(this,n):this.stack=(new Error).stack}function o(t,e){n.call(this,t,"BadRequest",400,"bad-request",e)}function i(t,e){n.call(this,t,"NotAuthenticated",401,"not-authenticated",e)}function u(t,e){n.call(this,t,"PaymentError",402,"payment-error",e)}function a(t,e){n.call(this,t,"Forbidden",403,"forbidden",e)}function c(t,e){n.call(this,t,"NotFound",404,"not-found",e)}function s(t,e){n.call(this,t,"MethodNotAllowed",405,"method-not-allowed",e)}function f(t,e){n.call(this,t,"NotAcceptable",406,"not-acceptable",e)}function l(t,e){n.call(this,t,"Timeout",408,"timeout",e)}function p(t,e){n.call(this,t,"Conflict",409,"conflict",e)}function y(t,e){n.call(this,t,"LengthRequired",411,"length-required",e)}function h(t,e){n.call(this,t,"Unprocessable",422,"unprocessable",e)}function d(t,e){n.call(this,t,"TooManyRequests",429,"too-many-requests",e)}function m(t,e){n.call(this,t,"GeneralError",500,"general-error",e)}function v(t,e){n.call(this,t,"NotImplemented",501,"not-implemented",e)}function b(t,e){n.call(this,t,"BadGateway",502,"bad-gateway",e)}function g(t,e){n.call(this,t,"Unavailable",503,"unavailable",e)}var C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w=r(9)("@feathersjs/errors");n.prototype=Object.create(Error.prototype),Object.defineProperty(n.prototype,"toJSON",{value:function(){return{name:this.name,message:this.message,code:this.code,className:this.className,data:this.data,errors:this.errors}}}),o.prototype=n.prototype,i.prototype=n.prototype,u.prototype=n.prototype,a.prototype=n.prototype,c.prototype=n.prototype,s.prototype=n.prototype,f.prototype=n.prototype,l.prototype=n.prototype,p.prototype=n.prototype,y.prototype=n.prototype,h.prototype=n.prototype,d.prototype=n.prototype,m.prototype=n.prototype,v.prototype=n.prototype,b.prototype=n.prototype,g.prototype=n.prototype;var j={FeathersError:n,BadRequest:o,NotAuthenticated:i,PaymentError:u,Forbidden:a,NotFound:c,MethodNotAllowed:s,NotAcceptable:f,Timeout:l,Conflict:p,LengthRequired:y,Unprocessable:h,TooManyRequests:d,GeneralError:m,NotImplemented:v,BadGateway:b,Unavailable:g,400:o,401:i,402:u,403:a,404:c,405:s,406:f,408:l,409:p,411:y,422:h,429:d,500:m,501:v,502:b,503:g};t.exports=Object.assign({convert:function(t){if(!t)return t;var e=j[t.name],r=e?new e(t.message,t.data):new Error(t.message||t);return"object"===(void 0===t?"undefined":C(t))&&Object.assign(r,t),r}},j)},function(t,e,r){(function(n){function o(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}(e=t.exports=r(10)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),r){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,i=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(i=o))}),t.splice(i,0,n)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=o,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(o())}).call(e,r(1))},function(t,e,r){function n(t){function r(){if(r.enabled){var t=r,o=+new Date,i=o-(n||o);t.diff=i,t.prev=n,t.curr=o,n=o;for(var u=new Array(arguments.length),a=0;a<u.length;a++)u[a]=arguments[a];u[0]=e.coerce(u[0]),"string"!=typeof u[0]&&u.unshift("%O");var c=0;u[0]=u[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;c++;var o=e.formatters[n];if("function"==typeof o){var i=u[c];r=o.call(t,i),u.splice(c,1),c--}return r}),e.formatArgs.call(t,u);(r.log||e.log||console.log.bind(console)).apply(t,u)}}var n;return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var r,n=0;for(r in t)n=(n<<5)-n+t.charCodeAt(r),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),r.destroy=o,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function o(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];var r,n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(r=0;r<e.instances.length;r++){var i=e.instances[r];i.enabled=e.enabled(i.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(11),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){function r(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var n=1e3,o=60*n,i=60*o,u=24*i,a=365.25*u;t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*a;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*i;case"minutes":case"minute":case"mins":case"min":case"m":return r*o;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===c&&!1===isNaN(t))return e.long?function(t){return r(t,u,"day")||r(t,i,"hour")||r(t,o,"minute")||r(t,n,"second")||t+" ms"}(t):function(t){return t>=u?Math.round(t/u)+"d":t>=i?Math.round(t/i)+"h":t>=o?Math.round(t/o)+"m":t>=n?Math.round(t/n)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){"use strict";function n(t,e){switch(u(t)){case"object":return function(t,e){if(o(t)||!0===e&&"object"===u(t)){var r={};return a(t,function(t,r){this[r]=n(t,e)},r),r}if("function"==typeof e)return e(t);return t}(t,e);case"array":return function(t,e){for(var r=[],o=0;o<t.length;o++)r[o]=n(t[o],e);return r}(t,e);default:return i(t)}}var o=r(2),i=r(14),u=r(5),a=r(16);t.exports=n},function(t,e,r){"use strict";t.exports=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)}},function(t,e,r){"use strict";function n(t){var e=u(t);return n.hasOwnProperty(e)?n[e](t):t}var o=r(3),i=r(15),u=r(5);n.array=function(t){return t.slice()},n.date=function(t){return new Date(+t)},n.object=function(t){return o(t)?i({},t):t},n.map=function(t){return new Map(t)},n.regexp=function(t){var e="";return e+=t.multiline?"m":"",e+=t.global?"g":"",e+=t.ignorecase?"i":"",new RegExp(t.source,e)},n.set=function(t){return new Set(t)},t.exports=n},function(t,e,r){"use strict";var n=r(3),o=r(4);t.exports=function(t,e){if(!n(t))throw new TypeError("expected the first argument to be an object");for(var r=arguments.length,i=0;++i<r;)!function(t,e){n(e)&&o(e,function(e,r){t[r]=e})}(t,arguments[i]);return t}},function(t,e,r){"use strict";var n=r(4),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){n(t,function(n,i){if(o.call(t,i))return e.call(r,t[i],i,t)})}},function(t,e,r){"use strict";var n=r(0),o=r(18),i=r(19),u=r(20);t.exports=Object.assign({},n,i,{hooks:o,filterQuery:u})},function(t,e,r){"use strict";function n(t){var e=u(t,2),r=e[0],n=e[1];return{id:r,params:void 0===n?{}:n}}function o(t){var e=u(t,3),r=e[0],n=e[1],o=e[2];return{id:r,data:n,params:void 0===o?{}:o}}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=t[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(0)._,c=a.each,s=a.pick;e.converters={find:function(t){var e=u(t,1)[0];return{params:void 0===e?{}:e}},create:function(t){var e=u(t,2),r=e[0],n=e[1];return{data:r,params:void 0===n?{}:n}},get:n,remove:n,update:o,patch:o},e.createHookObject=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e.converters[t](r);return Object.defineProperty(o,"toJSON",{value:function(){return s(this,"type","method","path","params","id","data","result","error")}}),Object.assign(o,n,{method:t,get path(){var t=n.app,e=n.service;return e&&t&&t.services?Object.keys(t.services).find(function(r){return t.services[r]===e}):null}})},e.defaultMakeArguments=function(t){var e=[];return void 0!==t.id&&e.push(t.id),t.data&&e.push(t.data),e.push(t.params||{}),e},e.makeArguments=function(t){switch(t.method){case"find":return[t.params];case"get":case"remove":return[t.id,t.params];case"update":case"patch":return[t.id,t.data,t.params];case"create":return[t.data,t.params]}return e.defaultMakeArguments(t)},e.convertHookData=function(t){var e={};return Array.isArray(t)?e={all:t}:"object"!==(void 0===t?"undefined":i(t))?e={all:[t]}:c(t,function(t,r){e[r]=Array.isArray(t)?t:[t]}),e},e.isHookObject=function(t){return"object"===(void 0===t?"undefined":i(t))&&"string"==typeof t.method&&"string"==typeof t.type},e.getHooks=function(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.__hooks[r][n]||[],u=e.__hooks[r][n]||[];return o?u.concat(i):i.concat(u)},e.processHooks=function(t,r){var n=this,o=r,i=function(t){if(t){if(!e.isHookObject(t))throw new Error(o.type+" hook for '"+o.method+"' method returned invalid hook object");o=t}return o},u=Promise.resolve(o);return t.forEach(function(t){var e=t.bind(n);u=(u=2===e.length?u.then(function(t){return new Promise(function(r,n){e(t,function(t,e){return t?n(t):r(e)})})}):u.then(e)).then(i)}),u.catch(function(t){throw t.hook=o,t})},e.enableHooks=function(t,r,n){if("function"==typeof t.hooks)return t;var o={};return n.forEach(function(t){o[t]={}}),Object.defineProperty(t,"__hooks",{value:o}),Object.assign(t,{hooks:function(t){var n=this;return c(t,function(t,o){if(!n.__hooks[o])throw new Error("'"+o+"' is not a valid hook type");var i=e.convertHookData(t);c(i,function(t,e){if("all"!==e&&-1===r.indexOf(e))throw new Error("'"+e+"' is not a valid hook method")}),r.forEach(function(t){var e=n.__hooks[o][t]||(n.__hooks[o][t]=[]);i.all&&e.push.apply(e,i.all),i[t]&&e.push.apply(e,i[t])})}),this}})}},function(t,e,r){"use strict";function n(t){return"object"===(void 0===t?"undefined":o(t))&&null!==t}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i={find:1,get:2,create:2,update:3,patch:3,remove:2};e.validateArguments=function(t,e){if("function"==typeof e[e.length-1])throw new Error("Callbacks are no longer supported. Use Promises or async/await instead.");var r=i[t];if(r&&e.length>r)throw new Error("Too many arguments for '"+t+"' method");var o=e[r-1];if(void 0!==o&&!n(o))throw new Error("Params for '"+t+"' method must be an object");switch(t){case"create":if(!n(e[0]))throw new Error("A data object must be provided to the 'create' method");break;case"get":case"remove":case"update":case"patch":if(void 0===e[0])throw new Error("An id must be provided to the '"+t+"' method");if(("update"===t||"patch"===t)&&!n(e[1]))throw new Error("A data object must be provided to the '"+t+"' method")}return!0}},function(t,e,r){"use strict";function n(t){if(void 0!==t)return Math.abs(parseInt(t,10))}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=r(0)._,u=["$sort","$limit","$skip","$select","$populate"];t.exports=function(t,e){return{filters:{$sort:function(t){if("object"!==(void 0===t?"undefined":o(t)))return t;var e={};return Object.keys(t).forEach(function(r){e[r]="object"===o(t[r])?t[r]:parseInt(t[r],10)}),e}(t.$sort),$limit:function(t,e){if(e&&e.default){var r="number"==typeof t?t:e.default,n="number"==typeof e.max?e.max:Number.MAX_VALUE;return Math.min(r,n)}return t}(n(t.$limit),e),$skip:n(t.$skip),$select:t.$select,$populate:t.$populate},query:i.omit.apply(i,[t].concat(u))}}},function(t,e){!function(){"use strict";function r(t){return"function"==typeof t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t){return t instanceof Date?t.getTime():n(t)?t.map(o):t&&"function"==typeof t.toJSON?t.toJSON():t}function i(t,e){return r(t.get)?t.get(e):t[e]}function u(t){return function(e,r){if(!n(r)||!r.length)return t(e,r);for(var o=0,u=r.length;o<u;o++)if(t(e,i(r,o)))return!0;return!1}}function a(t,e,r,n){return t.v(t.a,e,r,n)}function c(t,e){for(var r=0;r<t.length;r++){i(t,r);if(a(e,i(t,r)))return r}return-1}function s(t,e){return{a:t,v:e}}function f(t,e){var r=[];if(l(e,t.k,0,e,r),1===r.length){var n=r[0];return a(t.nv,n[0],n[1],n[2])}for(var o=0;o<r.length;o++){var i=r[o];if(a(t.nv,i[0],i[1],i[2]))return!0}return!1}function l(t,e,r,o,u){if(r!==e.length&&void 0!=t){var a=i(e,r);if(n(t)&&isNaN(Number(a)))for(var c=0,s=t.length;c<s;c++)l(i(t,c),e,r,t,u);else l(i(t,a),e,r+1,t,u)}else u.push([t,e[r-1],o])}function p(t,e){return{a:{k:t,nv:e},v:f}}function y(t){(t=o(t))&&function(t){return t&&t.constructor===Object}(t)||(t={$eq:t});var e=[];for(var r in t){var n=t[r];if("$options"!==r)if(m[r])v[r]&&(n=v[r](n,t)),e.push(s(o(n),m[r]));else{if(36===r.charCodeAt(0))throw new Error("Unknown operation "+r);e.push(p(r.split("."),y(n)))}}return 1===e.length?e[0]:s(e,m.$and)}function h(t,e){var r=y(t);return e&&(r={a:r,v:function(t,r,n,o){return a(t,e(r),n,o)}}),r}function d(t,e,n){function o(t,e,r){return a(i,t,e,r)}r(e)&&(n=e,e=void 0);var i=h(t,n);return e?e.filter(o):o}var m={$eq:u(function(t,e){return t(e)}),$ne:function(t){return function(e,r){if(!n(r)||!r.length)return t(e,r);for(var o=0,u=r.length;o<u;o++)if(!t(e,i(r,o)))return!1;return!0}}(function(t,e){return!t(e)}),$gt:u(function(t,e){return d.compare(o(e),t)>0}),$gte:u(function(t,e){return d.compare(o(e),t)>=0}),$lt:u(function(t,e){return d.compare(o(e),t)<0}),$lte:u(function(t,e){return d.compare(o(e),t)<=0}),$mod:u(function(t,e){return e%t[0]==t[1]}),$in:function(t,e){if(!(e instanceof Array)){var r=o(e);if(r===e&&"object"==typeof e)for(u=t.length;u--;)if(String(t[u])===String(e)&&"[object Object]"!==String(e))return!0;if(void 0===r)for(u=t.length;u--;)if(null==t[u])return!0;for(u=t.length;u--;){var n=a(h(i(t,u),void 0),e,u,t);if(n&&"[object Object]"!==String(n)&&"[object Object]"!==String(e))return!0}return!!~t.indexOf(r)}for(var u=e.length;u--;)if(~t.indexOf(o(i(e,u))))return!0;return!1},$nin:function(t,e,r,n){return!m.$in(t,e,r,n)},$not:function(t,e,r,n){return!a(t,e,r,n)},$type:function(t,e){return void 0!=e&&(e instanceof t||e.constructor==t)},$all:function(t,e,r,n){return m.$and(t,e,r,n)},$size:function(t,e){return!!e&&t===e.length},$or:function(t,e,r,n){for(var o=0,u=t.length;o<u;o++)if(a(i(t,o),e,r,n))return!0;return!1},$nor:function(t,e,r,n){return!m.$or(t,e,r,n)},$and:function(t,e,r,n){for(var o=0,u=t.length;o<u;o++)if(!a(i(t,o),e,r,n))return!1;return!0},$regex:u(function(t,e){return"string"==typeof e&&t.test(e)}),$where:function(t,e,r,n){return t.call(e,e,r,n)},$elemMatch:function(t,e,r,o){return n(e)?!!~c(e,t):a(t,e,r,o)},$exists:function(t,e,r,n){return n.hasOwnProperty(r)===t}},v={$eq:function(t){return t instanceof RegExp?function(e){return"string"==typeof e&&t.test(e)}:t instanceof Function?t:n(t)&&!t.length?function(t){return n(t)&&!t.length}:null===t?function(t){return null==t}:function(e){return 0===d.compare(o(e),t)}},$ne:function(t){return v.$eq(t)},$and:function(t){return t.map(y)},$all:function(t){return v.$and(t)},$or:function(t){return t.map(y)},$nor:function(t){return t.map(y)},$not:function(t){return y(t)},$regex:function(t,e){return new RegExp(t,e.$options)},$where:function(t){return"string"==typeof t?new Function("obj","return "+t):t},$elemMatch:function(t){return y(t)},$exists:function(t){return!!t}};d.use=function(t){if(r(t))return t(d);for(var e in t)36===e.charCodeAt(0)&&(m[e]=t[e])},d.indexOf=function(t,e,r){return c(e,h(t,r))},d.compare=function(t,e){if(t===e)return 0;if(typeof t==typeof e){if(t>e)return 1;if(t<e)return-1}},void 0!==t&&void 0!==t.exports&&(Object.defineProperty(e,"__esModule",{value:!0}),t.exports=d,e.default=t.exports.default=d),"undefined"!=typeof window&&(window.sift=d)}()}])});